<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>FriendFinder: A Survey</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="public/style.css">
	<script type="text/javascript" src="server2.js" ></script>

</head>
<body>

<div class="container-fluid">
<div class="jumbotron">
	
	<h1>Survey Questions</h1>
	<hr>
	<form method="POST" action="/api/friends">
		<h3><strong>About You</strong></h3>
		<fieldset class="form-group">
			<label for="name">Name (Required)</label>
			<input type="text" class="form-control" placeholder="Your Name" id="name" name="name" required>
		</fieldset>
		<fieldset class="form-group">
			<label for="photo">link to photo</label>

			<input type="text" name="" id="name" class="form-control" required>
			<h4>Link to Photo Image (Required)</h4>
			<input type="text" name="" id="photo" class="form-control" required>
			<hr>
		</fieldset>
	</form>

		<h4><strong>Question 1</strong></h4>
		<fieldset class="form-group">
			<label for="question01">You have no patience for dating because you're learning to code</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question01" name="scores[0]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 2</strong></h4>
		<fieldset class="form-group">
			<label for="question02">You like to connect with someone but you'd rather have your Express connect with your Node first.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question02" name="scores[1]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 3</strong></h4>
		<fieldset class="form-group">
			<label for="question03">You find it easy to stay relaxed even when there is pressure to finish your homework.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question03" name="scores[2]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 4</strong></h4>
		<fieldset class="form-group">
			<label for="question04">You prefer to code with a friend than be with someone like Sophie Hoeks.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question04" name="scores[3]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 5</strong></h4>
		<fieldset class="form-group">
			<label for="question05">A real programmer has no time for dating.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question05" name="scores[4]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 6</strong></h4>
		<fieldset class="form-group">
			<label for="question06">It is often difficult for you to relate to other people’s code.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question06" name="scores[5]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 7</strong></h4>
		<fieldset class="form-group">
			<label for="question07">Coding makes you bathe less.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question07" name="scores[6]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 8</strong></h4>
		<fieldset class="form-group">
			<label for="question08">You rarely get carried away by current events when you can't even handle an event listener.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question08" name="scores[7]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 9</strong></h4>
		<fieldset class="form-group">
			<label for="question09">You think everyone’s views should be respected regardless of whether they can code or not.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question09" name="scores[8]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset>
		<h4><strong>Question 10</strong></h4>
		<fieldset class="form-group">
			<label for="question10">You feel more legit after spending time with programmers than your loved ones.</label>
			<br>
			<div class="col-md-4">
				<select class="form-control" id="question10" name="scores[9]">
					<option>1 (Strongly Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
		</fieldset><br>
		<input type="submit" class="btn btn-primary" value="Request Friend" id="submit">
	</form>
</div>
	
<button type="button" id="submit" class="btn btn-success btn-lg btn-block" data-toggle="modal" data-target="#modal"><i class="fa fa-check-square" aria-hidden="true"></i> Submit</button>
		</form>
		<br />
		<footer class="footer">
			<div class="container">
				<p><a href="/api/friends" target='_blank'>API Friends List</a> | <a href="https://github.com/cbrenner04/FriendFinder" target='_blank'>GitHub</a></p>
			</div>
		</footer>
		</div>
<div class="modal fade" id="modal" role="dialog">
	<div class="modal-dialog modal-sm">
	<div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h4 class="modal-title"></h4>
		</div>
		<div class="modal-body"></div>
		<div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		</div>
	</div>
</div>
</div>

<script type="text/javascript">
	var nameVal, imageVal, q1Val, q2Val, q3Val, q4Val, q5Val, q6Val, q7Val, q8Val, q9Val, q10Val, newPerson;
        event.preventDefault();
 
        nameVal = $('#name').val();
        imageVal = $('#image').val();
        q1Val = parseInt($('#q1').val());
        q2Val = parseInt($('#q2').val());
        q3Val = parseInt($('#q3').val());
        q4Val = parseInt($('#q4').val());
        q5Val = parseInt($('#q5').val());
        q6Val = parseInt($('#q6').val());
        q7Val = parseInt($('#q7').val());
        q8Val = parseInt($('#q8').val());
        q9Val = parseInt($('#q9').val());
        q10Val = parseInt($('#q10').val());
        newPerson = {
            name: nameVal,
            image: imageVal,
            responses: [q1Val, q2Val, q3Val, q4Val, q5Val, q6Val, q7Val, q8Val, q9Val, q10Val],
            total: q1Val + q2Val + q3Val + q4Val + q5Val + q6Val + q7Val + q8Val + q9Val + q10Val
        };

        var modalTitle = $('.modal-title');
        var modalBody = $('.modal-body');
        var modal = $('#modal');
        var friendsLocate = '/api/friends';
        if (formIsValid()) {
            $.get(friendsLocate, function(data) {
                var match = perfectMatch(data);
                if (match.name !== undefined) {
                    modalTitle.text('You found your destiny!');
                    modalBody.html('<p class="strong">You belong to:</p><p>' + match.name + '</p><img src="' + match.image + '" height="45">');
                } else {
                    modalTitle.text('Too few friends');
                    modalBody.text('Sorry, no one wants to be friends with you.');
                }
            }).then(function() {
                modal.show();
                $('.form')[0].reset();
                $.post(friendsLocate, newPerson);
            });
        } else {
            modalTitle.text('Error');
            modalBody.text('Please make sure all questions have been filled in.');
            modal.show();
        }
    function formIsValid() {
        return (nameVal !== '' && imageVal !== '' && !isNaN(q1Val) && !isNaN(q2Val) && !isNaN(q3Val) && !isNaN(q4Val) &&
            !isNaN(q5Val) && !isNaN(q6Val) && !isNaN(q7Val) && !isNaN(q8Val) && !isNaN(q9Val) && !isNaN(q10Val));
    }
    function makeMatch(data) {
        var difference = 50;
        var minName;
        var minImage;
        data.forEach(function(person) {
            var localDiff = Math.abs(newPerson.total - person.total);
            if (localDiff < difference) {
                difference = localDiff;
                minName = person.name;
                minImage = person.image;
            }
        });
        return {
            name: minName,
            image: minImage
        };
    }
    </script>
</body>

</html>